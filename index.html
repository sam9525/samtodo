<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="./vendor/fontawesome-free-5.15.1-web/css/fontawesome.css">
	<link rel="stylesheet" href="./vendor/fontawesome-free-5.15.1-web/css/brands.css">
    <link rel="stylesheet" href="./vendor/fontawesome-free-5.15.1-web/css/solid.css">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div class="wrapper">
        <div class="todo">
            <h1 class="title">Todo List</h1>
            <div class="content">
                <span>You have <span class="pendingTasks"></span> pending tasks</span>
                <button class="clear">CLEAR</button>
            </div>
        </div>
        <div class="input">
            <input type="text" class="ant" placeholder="Add new todo">
            <button class="add"><i class="fas fa-plus"></i></button>
        </div>
        <ul class="todolist">
            
        </ul>   
        <div class="editbox disNone">
            <i class="index"></i>
            <input type="text" class="et" placeholder="Edit todo">
            <button class="okay">OK</button> 
        </div> 
    </div>
</body>
<script>
    const addBtn = document.querySelector('.add')
    const inputBox = document.querySelector('.ant')
    const todoList = document.querySelector('.todolist')
    const clearAll = document.querySelector('.clear')
    const editBox = document.querySelector('.editbox')
    var listArray = []

    showTasks()
    function showTasks(){
        let userValue = inputBox.value
        let getLocalStorageData = localStorage.getItem('NewTodo')
        if(getLocalStorageData == null){
            listArray = []
        }else {
            listArray = JSON.parse(getLocalStorageData)
        }
        const pendingTasksNumber = document.querySelector('.pendingTasks')
        pendingTasksNumber.textContent = listArray.length;
        let newTodoList = ''
        listArray.forEach((element, index) => {
            newTodoList += `
                <li>
                    <div class="box">
                        <div class="para">${element}</div>
                        <div class="icon del" onclick="deletedTask"><i class="fas fa-trash-alt"></i></div>
                        <div class="icon edit" onclick="openEditTask(${index})"><i class="fas fa-pencil-alt"></i></div>
                    </div>
                </li>
            `
        })
        todoList.innerHTML = newTodoList
        inputBox.value = ''
    }   
    addBtn.onclick = () => {
        let userValue = inputBox.value
        if(userValue !== ""){
            let getLocalStorageData = localStorage.getItem('NewTodo')
            if(getLocalStorageData == null){
                listArray = []
            }else{
                listArray = JSON.parse(getLocalStorageData)
            }
            listArray.push(userValue)
            localStorage.setItem('NewTodo',JSON.stringify(listArray))
            showTasks()
        }
    }
    function deletedTask(index){
        let getLocalStorageData = localStorage.getItem('NewTodo')
        listArray = JSON.parse(getLocalStorageData)
        listArray.splice(index, 1)
        local.Storage.setItem("NewTodo", JSON.stringify(listArray))
        showTasks()
    }
    clearAll.onclick = () => {
        listArray = []
        localStorage.setItem("NewTodo", JSON.stringify(listArray))
        showTasks()
    }
    function openEditTask(index){
        let getLocalStorageData  = localStorage.getItem('NewTodo')
        listArray = JSON.parse(getLocalStorageData)
        editValue = listArray[index]
        editBox.querySelector('input').value = listArray[index]
        editBox.querySelector('.index').innerText = index
        editBox.classList.remove('disNone')
    }
    editBox.querySelector('button').onclick = () => {
        let editValue = editBox.querySelector('input').value
        let index = editBox.querySelector('.index').innerText
        let getLocalStorageData = localStorage.getItem('NewTodo')
        listArray = JSON.parse(getLocalStorageData);
        listArray.splice(index, 1, editValue);
        localStorage.setItem("NewTodo", JSON.stringify(listArray));
        showTasks();
        editBox.classList.add("disNone");
    }
</script>
</html>